----- nvidia-smi output at Tue 12 Nov 2024 16:39:58 AEDT -----
Tue Nov 12 16:39:59 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 560.35.03              Driver Version: 560.35.03      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    Off |   00000000:21:00.0 Off |                    0 |
| N/A   35C    P0             91W /  350W |       1MiB /  46068MiB |      3%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Package                       Version     Editable project location
----------------------------- ----------- ------------------------------------------------------------------------------------------
accelerate                    1.1.1
aiofiles                      23.2.1
aiohappyeyeballs              2.4.3
aiohttp                       3.10.10
aiosignal                     1.3.1
alabaster                     0.7.16
altair                        5.3.0
annotated-types               0.7.0
antlr4-python3-runtime        4.9.3
anyio                         3.7.1
asttokens                     2.4.1
async-timeout                 4.0.3
attrs                         24.2.0
babel                         2.16.0
bert-score                    0.3.13
bitsandbytes                  0.44.1
certifi                       2024.8.30
charset-normalizer            3.4.0
click                         8.1.7
comm                          0.2.2
contourpy                     1.3.0
cycler                        0.12.1
datasets                      3.0.2
debugpy                       1.8.7
decorator                     4.4.2
decord                        0.6.0
dill                          0.3.8
distro                        1.9.0
docutils                      0.18.1
einops                        0.6.1
einops-exts                   0.0.4
et_xmlfile                    2.0.0
evaluate                      0.4.3
exceptiongroup                1.2.2
executing                     2.1.0
fastapi                       0.103.2
ffmpy                         0.4.0
filelock                      3.16.1
fonttools                     4.54.1
frozenlist                    1.5.0
fsspec                        2024.9.0
ftfy                          6.3.1
gradio                        4.16.0
gradio_client                 0.8.1
h11                           0.14.0
httpcore                      0.17.3
httpx                         0.24.0
huggingface-hub               0.26.1
idna                          3.10
imageio                       2.36.0
imageio-ffmpeg                0.5.1
imagesize                     1.4.1
importlib_metadata            8.5.0
importlib_resources           6.4.5
ipykernel                     6.29.5
ipython                       8.18.1
jedi                          0.19.1
Jinja2                        3.1.4
joblib                        1.4.2
jsonschema                    4.23.0
jsonschema-specifications     2024.10.1
jupyter_client                8.6.3
jupyter_core                  5.7.2
kiwisolver                    1.4.7
latex2mathml                  3.77.0
liger_kernel                  0.3.1
Markdown                      3.7
markdown-it-py                3.0.0
markdown2                     2.5.1
MarkupSafe                    2.1.5
matplotlib                    3.9.2
matplotlib-inline             0.1.7
mdit-py-plugins               0.4.2
mdurl                         0.1.2
model-index                   0.1.11
modelindex                    0.0.2
moviepy                       1.0.3
mpmath                        1.3.0
multidict                     6.1.0
multiprocess                  0.70.16
myst-parser                   3.0.1
narwhals                      1.13.2
nest-asyncio                  1.6.0
networkx                      3.2.1
nltk                          3.9.1
numpy                         1.26.4
nvidia-cublas-cu12            12.1.3.1
nvidia-cuda-cupti-cu12        12.1.105
nvidia-cuda-nvrtc-cu12        12.1.105
nvidia-cuda-runtime-cu12      12.1.105
nvidia-cudnn-cu12             8.9.2.26
nvidia-cufft-cu12             11.0.2.54
nvidia-curand-cu12            10.3.2.106
nvidia-cusolver-cu12          11.4.5.107
nvidia-cusparse-cu12          12.1.0.106
nvidia-nccl-cu12              2.18.1
nvidia-nvjitlink-cu12         12.4.127
nvidia-nvtx-cu12              12.1.105
omegaconf                     2.3.0
open_clip_torch               2.29.0
openai                        1.3.5
opencv-python                 4.10.0.84
openpyxl                      3.1.5
ordered-set                   4.1.0
orjson                        3.10.11
packaging                     24.1
pandas                        2.2.3
parso                         0.8.4
peft                          0.13.2
pexpect                       4.9.0
pillow                        10.4.0
pip                           24.2
platformdirs                  4.3.6
portalocker                   2.10.1
proglog                       0.1.10
prompt_toolkit                3.0.48
propcache                     0.2.0
protobuf                      5.28.3
psutil                        6.1.0
ptyprocess                    0.7.0
pure_eval                     0.2.3
pyarrow                       18.0.0
pycocoevalcap                 1.2
pycocotools                   2.0.8
pydantic                      2.9.2
pydantic_core                 2.23.4
pydub                         0.25.1
Pygments                      2.18.0
pyparsing                     3.2.0
python-dateutil               2.9.0.post0
python-dotenv                 1.0.1
python-multipart              0.0.17
pytorch_sphinx_theme          0.0.24      /srv/scratch/CRUISE/Breeze/Project/Llava/COMP9444_Llava/benchmark/src/pytorch-sphinx-theme
pytz                          2024.2
PyYAML                        6.0.2
pyzmq                         26.2.0
referencing                   0.35.1
regex                         2024.9.11
requests                      2.32.3
rich                          13.9.4
rpds-py                       0.20.1
ruff                          0.7.2
safetensors                   0.4.5
scikit-learn                  1.2.2
scipy                         1.13.1
semantic-version              2.10.0
sentencepiece                 0.1.99
setuptools                    75.1.0
shellingham                   1.5.4
shortuuid                     1.0.13
six                           1.16.0
sniffio                       1.3.1
snowballstemmer               2.2.0
Sphinx                        6.1.3
sphinx-copybutton             0.5.2
sphinx_design                 0.6.1
sphinx-notfound-page          1.0.4
sphinx-tabs                   3.4.7
sphinxcontrib-applehelp       2.0.0
sphinxcontrib-devhelp         2.0.0
sphinxcontrib-htmlhelp        2.1.0
sphinxcontrib-jquery          4.1
sphinxcontrib-jsmath          1.0.1
sphinxcontrib-qthelp          2.0.0
sphinxcontrib-serializinghtml 2.0.0
stack-data                    0.6.3
starlette                     0.27.0
sty                           1.0.6
svgwrite                      1.4.3
sympy                         1.13.1
tabulate                      0.9.0
threadpoolctl                 3.5.0
tiktoken                      0.8.0
timeout-decorator             0.5.0
timm                          0.6.13
tokenizers                    0.20.3
tomlkit                       0.12.0
toolz                         1.0.0
torch                         2.1.2
torchvision                   0.16.2
tornado                       6.4.1
tqdm                          4.66.5
traitlets                     5.14.3
transformers                  4.46.2
triton                        2.1.0
typer                         0.12.5
typing_extensions             4.7.1
tzdata                        2024.2
urllib3                       2.2.3
uvicorn                       0.32.0
validators                    0.34.0
vlmeval                       0.1.0       /srv/scratch/CRUISE/Breeze/Project/Llava/COMP9444_Llava/benchmark/VLMEvalKit
wavedrom                      2.0.3.post3
wcwidth                       0.2.13
websockets                    11.0.3
wheel                         0.44.0
XlsxWriter                    3.2.0
xxhash                        3.5.0
yarl                          1.17.1
zipp                          3.20.2
The following values were not passed to `accelerate launch` and had defaults used instead:
	`--num_machines` was set to a value of `1`
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:09,  3.26s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:06<00:06,  3.16s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:09<00:03,  3.14s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:10<00:00,  2.38s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:10<00:00,  2.67s/it]
Using the latest cached version of the dataset since Trelis/chess_pieces couldn't be found on the Hugging Face Hub (offline mode is enabled).
Found the latest cached dataset configuration 'default' at /srv/scratch/CRUISE/Breeze/.cache/huggingface/datasets/Trelis___chess_pieces/default/0.0.0/332c876be2f430b530d18deb1895308192bcf1ba (last modified on Mon Nov 11 07:52:16 2024).
  0%|          | 0/48 [00:00<?, ?it/s]/srv/scratch/CRUISE/Breeze/miniconda/envs/llava/lib/python3.9/site-packages/torch/utils/checkpoint.py:61: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
  2%|▏         | 1/48 [00:07<06:09,  7.87s/it]  4%|▍         | 2/48 [00:09<03:08,  4.11s/it]  6%|▋         | 3/48 [00:10<02:10,  2.90s/it]  8%|▊         | 4/48 [00:12<01:42,  2.34s/it] 10%|█         | 5/48 [00:13<01:27,  2.03s/it] 12%|█▎        | 6/48 [00:15<01:17,  1.84s/it] 15%|█▍        | 7/48 [00:16<01:10,  1.72s/it] 17%|█▋        | 8/48 [00:18<01:05,  1.64s/it] 19%|█▉        | 9/48 [00:19<01:01,  1.59s/it] 21%|██        | 10/48 [00:21<00:59,  1.55s/it] 23%|██▎       | 11/48 [00:22<00:56,  1.53s/it]                                                23%|██▎       | 11/48 [00:22<00:56,  1.53s/it] 25%|██▌       | 12/48 [00:24<00:54,  1.51s/it] 27%|██▋       | 13/48 [00:25<00:52,  1.51s/it] 29%|██▉       | 14/48 [00:27<00:50,  1.50s/it] 31%|███▏      | 15/48 [00:28<00:49,  1.49s/it] 33%|███▎      | 16/48 [00:30<00:47,  1.49s/it] 35%|███▌      | 17/48 [00:31<00:46,  1.49s/it]----- nvidia-smi output at Tue 12 Nov 2024 16:41:00 AEDT -----
Tue Nov 12 16:41:00 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 560.35.03              Driver Version: 560.35.03      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    Off |   00000000:21:00.0 Off |                    0 |
| N/A   55C    P0            322W /  350W |   42777MiB /  46068MiB |    100%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    124651      C   ...eze/miniconda/envs/llava/bin/python      42768MiB |
+-----------------------------------------------------------------------------------------+
 38%|███▊      | 18/48 [00:32<00:44,  1.48s/it] 40%|███▉      | 19/48 [00:34<00:43,  1.48s/it] 42%|████▏     | 20/48 [00:35<00:41,  1.48s/it] 44%|████▍     | 21/48 [00:37<00:40,  1.48s/it] 46%|████▌     | 22/48 [00:38<00:38,  1.48s/it]                                                46%|████▌     | 22/48 [00:38<00:38,  1.48s/it] 48%|████▊     | 23/48 [00:40<00:37,  1.48s/it] 50%|█████     | 24/48 [00:41<00:35,  1.48s/it] 52%|█████▏    | 25/48 [00:43<00:34,  1.48s/it] 54%|█████▍    | 26/48 [00:44<00:32,  1.48s/it] 56%|█████▋    | 27/48 [00:46<00:31,  1.48s/it] 58%|█████▊    | 28/48 [00:47<00:29,  1.48s/it] 60%|██████    | 29/48 [00:49<00:28,  1.48s/it] 62%|██████▎   | 30/48 [00:50<00:26,  1.49s/it] 65%|██████▍   | 31/48 [00:52<00:25,  1.49s/it] 67%|██████▋   | 32/48 [00:53<00:23,  1.48s/it] 69%|██████▉   | 33/48 [00:55<00:22,  1.48s/it]                                                69%|██████▉   | 33/48 [00:55<00:22,  1.48s/it] 71%|███████   | 34/48 [00:56<00:20,  1.48s/it] 73%|███████▎  | 35/48 [00:58<00:19,  1.49s/it] 75%|███████▌  | 36/48 [00:59<00:17,  1.49s/it] 77%|███████▋  | 37/48 [01:01<00:16,  1.49s/it] 79%|███████▉  | 38/48 [01:02<00:14,  1.48s/it] 81%|████████▏ | 39/48 [01:04<00:13,  1.48s/it] 83%|████████▎ | 40/48 [01:05<00:11,  1.48s/it] 85%|████████▌ | 41/48 [01:07<00:10,  1.48s/it] 88%|████████▊ | 42/48 [01:08<00:08,  1.49s/it] 90%|████████▉ | 43/48 [01:10<00:07,  1.49s/it] 92%|█████████▏| 44/48 [01:11<00:05,  1.49s/it]                                                92%|█████████▏| 44/48 [01:11<00:05,  1.49s/it] 94%|█████████▍| 45/48 [01:13<00:04,  1.49s/it] 96%|█████████▌| 46/48 [01:14<00:02,  1.49s/it] 98%|█████████▊| 47/48 [01:16<00:01,  1.49s/it]100%|██████████| 48/48 [01:17<00:00,  1.51s/it]/srv/scratch/CRUISE/Breeze/miniconda/envs/llava/lib/python3.9/site-packages/peft/utils/save_and_load.py:243: UserWarning: Could not find a config file in llava-hf/llama3-llava-next-8b-hf - will assume that the vocabulary was not modified.
  warnings.warn(
                                               100%|██████████| 48/48 [01:17<00:00,  1.51s/it]100%|██████████| 48/48 [01:17<00:00,  1.62s/it]
/srv/scratch/CRUISE/Breeze/miniconda/envs/llava/lib/python3.9/site-packages/peft/utils/save_and_load.py:243: UserWarning: Could not find a config file in llava-hf/llama3-llava-next-8b-hf - will assume that the vocabulary was not modified.
  warnings.warn(
{'loss': 14.239, 'grad_norm': 155.31341552734375, 'learning_rate': 1.816969893010442e-05, 'epoch': 0.23}
{'loss': 7.8767, 'grad_norm': 78.06073760986328, 'learning_rate': 1.2034560130526341e-05, 'epoch': 0.46}
{'loss': 4.9655, 'grad_norm': 31.325611114501953, 'learning_rate': 4.804160499645667e-06, 'epoch': 0.69}
{'loss': 4.2545, 'grad_norm': 10.327860832214355, 'learning_rate': 3.708271265220087e-07, 'epoch': 0.92}
{'train_runtime': 77.7526, 'train_samples_per_second': 0.617, 'train_steps_per_second': 0.617, 'train_loss': 7.532796740531921, 'epoch': 1.0}
Tue Nov 12 16:41:49 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 560.35.03              Driver Version: 560.35.03      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    Off |   00000000:21:00.0 Off |                    0 |
| N/A   54C    P0            101W /  350W |       1MiB /  46068MiB |      3%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
